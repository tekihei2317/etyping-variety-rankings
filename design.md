# 設計

## 作りたいもの

e-typingのバラエティ（全13種目）のスコアの合計点を競う、ランキングページを作成する。

## 制作の動機

e-typingのバラエティは、ビジネスや長文を除きプレイしている人が少ない。この原因は、種目が多いのでどれをするのがいいか分からなかったり、バラエティをする動機付けがなかったり、人が集まりにくいことなどが考えられる。

そこで、バラエティの各種目のポイントや合計点を一度に確認できるようなページ（Webサイトまたは、スプレッドシート）を作成し、バラエティに取り組むことをより面白くできるようにしたい。

## 考慮するポイント

- e-typingのバラエティには全部で13個の種目がある。ビジネス、スタディ、ライフ、トラベル、スポーツ、なんだろな？、脳トレ、方言、長文、テンキー、百人一首、しりとり、医療介護。それぞれの種目にいくつかお題があり、その中の一つがランキングの対象となっている（例: ビジネスの現在のランキング種目は、プレゼンの基本）。
- e-typingからのデータ取得について。現時点(2025-06-22)でのランキングのページ数は、13種目それぞれについて32、8、18、8、8、11、5、6、33、5、5、9、12の合計160ページあった。なるべくサイトに負荷をかけないように、プログラムでのデータ取得は1週間に1回程度にしておきたい。[e-typing利用規約](https://www.e-typing.ne.jp/rules/)も要確認。
- e-typingはユーザー名を自由に変更できるので、同じユーザーが複数の名前でランキング登録する場合がある。そのため、ランキング登録名とユーザー名を関連付ける仕組みが必要。

## スプレッドシート版について

データ取得を頻繁に行えない関係上、ユーザーがスコアを更新したい場合に手動で変更する仕組みが必要になる。そこで、最初はデータソースにスプレッドシートを使うことにし、ここにランキングも表示することにする。アプリケーションの動作が安定したら、ここからデータを取得してWebサイトを作成したい。

スプレッドシート版は、以下の4つのシートを用意してランキング機能を実現する。

1. ランキング
2. スコア登録（自動）
3. スコア登録（手動）
4. 登録名・ユーザー名対応表

### 1. ランキング

ユーザーと、各種目のスコア、合計点、ランキングを表示する。表には書いていないが合計点後ろにスコアの更新日も表示したい。

| 順位 | ユーザー名 | 合計点 | ビジネス | スタディ | ライフ | トラベル | スポーツ | なんだろな？ | 脳トレ | 方言 | 長文 | テンキー | 百人一首 | しりとり | 医療介護 |
| ---- | ---------- | ------ | -------- | -------- | ------ | -------- | -------- | ------------ | ------ | ---- | ---- | -------- | -------- | -------- | -------- |
| 1    | ふらな     | 6039   | 634      | 485      | 591    | 534      | 540      | 571          | 170    | 618  | 740  |          | 575      |          | 581      |
| 2    | orih       | 6536   | 524      | 474      | 538    | 495      | 439      | 541          | 163    | 477  | 610  | 282      | 507      | 910      | 576      |
| 3    | 鉄馬       | 5162   | 566      | 397      | 476    | 428      | 436      | 518          | 104    | 510  | 707  |          | 506      |          | 514      |
| 4    | たらたら   | 4939   | 606      | 503      | 572    |          | 482      |              | 564    |      |      | 548      | 1021     | 643      |          |

### 2. スコア登録（自動）

e-typingのサイトから取得したデータを順番に保存していく。すべてのデータを登録すると量が多くなりそうなので、スコアを更新した場合のデータのみを登録するべきか。

| 取得日     | 種目     | お題         | e-typing登録名 | スコア |
| ---------- | -------- | ------------ | -------------- | ------ |
| 2025-06-22 | スタディ | 元素名       | 鉄馬@月配列    | 397    |
| 2025-06-22 | ライフ   | 天気のことば | tsato          | 476    |
| 2025-06-22 | トラベル | 世界遺産     | tsato          | 428    |

### 3. スコア登録（手動）

スコア登録（自動）の更新頻度は1週間に1回程度を想定しているので、手動でもランキングに登録できるようにしておく。内容はスコアの自動登録とほぼ同じ。

お題は決まっている（いつ更新されるか分からないが、3ヶ月程度は更新されていない）ので、自動入力するか、列を隠しておきたい。

| 日付       | 種目     | お題         | e-typing登録名 | スコア |
| ---------- | -------- | ------------ | -------------- | ------ |
| 2025-06-22 | スタディ | 元素名       | 鉄馬@月配列    | 397    |
| 2025-06-22 | ライフ   | 天気のことば | tsato          | 476    |
| 2025-06-22 | トラベル | 世界遺産     | tsato          | 428    |

### 4. 登録名・ユーザー名対応表

e-typingに登録している名前と、ランキングで使用したいユーザー名の対応を書く。

| e-typing登録名 | ユーザー名 |
| -------------- | ---------- |
| tsato          | 鉄馬       |
| 鉄馬@月配列    | 鉄馬       |
| nrf            | ふらな     |
| RForih         | orih       |

この表に書かれていない登録名は、そのままユーザー名として扱うこととする。
